jQuery(function($){"use strict";try{window.clover=new Clover(woocci_params.key);var elements=window.clover.elements()}catch(error){console.log(error);return}var woocci_gateway={mountElements:function(){if(!$("#clover-card-element").length){return}window.clover_card.mount("#clover-card-element");window.clover_exp.mount("#clover-exp-element");window.clover_cvc.mount("#clover-cvc-element");window.clover_zip.mount("#clover-zip-element")},createElements:function(){var elementStyles={input:{height:"30px",iconColor:"#666EE8",color:"#31325F",fontSize:"12px","::placeholder":{color:"#CFD7E0"}},img:{right:"4px !important",top:"4px !important",height:"20px !important"}};var elementClasses={focus:"focused",empty:"empty",invalid:"invalid"};elementStyles=woocci_params.elements_styling?woocci_params.elements_styling:elementStyles;window.clover_card=elements.create("CARD_NUMBER",elementStyles);window.clover_exp=elements.create("CARD_DATE",elementStyles);window.clover_cvc=elements.create("CARD_CVV",elementStyles);window.clover_zip=elements.create("CARD_POSTAL_CODE",elementStyles);try{window.clover_card.addEventListener("change",function(event){woocci_gateway.onCCFormChange()});window.clover_exp.addEventListener("change",function(event){woocci_gateway.onCCFormChange()});window.clover_cvc.addEventListener("change",function(event){woocci_gateway.onCCFormChange()});window.clover_zip.addEventListener("change",function(event){woocci_gateway.onCCFormChange()})}catch(e){}if("yes"===woocci_params.is_checkout){$(document.body).on("updated_checkout",function(){if($("#clover-card-element").children().length){return}woocci_gateway.mountElements()})}else if($("form#add_payment_method").length||$("form#order_review").length){woocci_gateway.mountElements()}},init:function(){if($("form.woocommerce-checkout").length){this.form=$("form.woocommerce-checkout");this.form.on("checkout_place_order",this.onSubmit)}if($("form#order_review").length){this.form=$("form#order_review")}$("form#order_review, form#add_payment_method").on("submit",this.onSubmit);if($("form#add_payment_method").length){this.form=$("form#add_payment_method")}$("form.woocommerce-checkout").on("change",this.reset);$(document).on("cloverError",this.onError).on("checkout_error",this.reset);if(woocci_params.inline_form==="1"){woocci_gateway.createElements()}},isCloverCardChosen:function(){return $("#payment_method_woocci_zaytech").is(":checked")},hasSource:function(){return 0<$("input.clover-source").length},isMobile:function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){return true}return false},block:function(){woocci_gateway.form.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){woocci_gateway.form&&woocci_gateway.form.unblock()},getSelectedPaymentElement:function(){return $('.payment_methods input[name="payment_method"]:checked')},getOwnerDetails:function(){var first_name=$("#billing_first_name").length?$("#billing_first_name").val():woocci_params.billing_first_name,last_name=$("#billing_last_name").length?$("#billing_last_name").val():woocci_params.billing_last_name,owner={name:"",address:{},email:"",phone:""};owner.name=first_name;if(first_name&&last_name){owner.name=first_name+" "+last_name}owner.email=$("#billing_email").val();owner.phone=$("#billing_phone").val();if(typeof owner.phone==="undefined"||0>=owner.phone.length){delete owner.phone}if(typeof owner.email==="undefined"||0>=owner.email.length){if($("#stripe-payment-data").data("email").length){owner.email=$("#stripe-payment-data").data("email")}else{delete owner.email}}if(typeof owner.name==="undefined"||0>=owner.name.length){delete owner.name}owner.address.line1=$("#billing_address_1").val()||woocci_params.billing_address_1;owner.address.line2=$("#billing_address_2").val()||woocci_params.billing_address_2;owner.address.state=$("#billing_state").val()||woocci_params.billing_state;owner.address.city=$("#billing_city").val()||woocci_params.billing_city;owner.address.postal_code=$("#billing_postcode").val()||woocci_params.billing_postcode;owner.address.country=$("#billing_country").val()||woocci_params.billing_country;return{owner:owner}},createSource:function(){var res=window.clover.createToken().then(woocci_gateway.sourceResponse)},sourceResponse:function(response){if(!response.token){if(response.errors){return $(document.body).trigger("cloverError",response)}this.unblock();return $(document.body).trigger("cloverError",response)}woocci_gateway.reset();woocci_gateway.form.append($('<input type="hidden" />').addClass("clover-source").attr("name","clover-source").val(response.token));woocci_gateway.form.append($('<input type="hidden" />').addClass("clover-card").attr("name","clover-card").val(JSON.stringify(response.card)));if($("form#add_payment_method").length){$(woocci_gateway.form).off("submit",woocci_gateway.form.onSubmit)}woocci_gateway.form.submit()},onSubmit:function(){console.log("Form Submitted");if(!woocci_gateway.isCloverCardChosen()){return true}if(woocci_params.inline_form==="1"){if(woocci_gateway.hasSource()){return true}woocci_gateway.block();woocci_gateway.createSource();setTimeout(woocci_gateway.unblock(),1e4);return false}else{return true}},onCCFormChange:function(){woocci_gateway.reset()},reset:function(){if(!$(".clover-errors>ul>li").length){$(".clover-errors>.clover-errors").remove()}$(".clover-source").remove();$(".clover-card").remove()},onError:function(e,result){console.log(result);var selectedMethodElement=woocci_gateway.getSelectedPaymentElement().closest("li");var errorContainer=$("#wc-woocci_zaytech-cc-form .clover-errors");$(errorContainer).html('<ul class="woocommerce_error woocommerce-error clover-errors">'+'<li class="card_number_error" />'+'<li class="date_error" />'+'<li class="cvv_error" />'+'<li class="zip_error" />'+"</ul>");if(result.errors.CARD_NUMBER){var car_number_message=result.errors.CARD_NUMBER;$(errorContainer).find(".card_number_error").text(car_number_message)}else{var car_number_message="";$(errorContainer).find(".card_number_error").remove()}if(result.errors.CARD_CVV){var cvv_message=result.errors.CARD_CVV;$(errorContainer).find(".cvv_error").text(cvv_message)}else{var cvv_message="";$(errorContainer).find(".cvv_error").remove()}if(result.errors.CARD_DATE){var date_message=result.errors.CARD_DATE;$(errorContainer).find(".date_error").text(date_message)}else{var date_message="";$(errorContainer).find(".date_error").remove()}if(result.errors.CARD_POSTAL_CODE){var zip_message=result.errors.CARD_POSTAL_CODE;$(errorContainer).find(".zip_error").text(zip_message)}else{var zip_message="";$(errorContainer).find(".zip_error").remove()}woocci_gateway.reset();woocci_gateway.unblock();$.unblockUI()},submitError:function(error_message){$(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove();woocci_gateway.form.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+error_message+"</div>");woocci_gateway.form.removeClass("processing").unblock();woocci_gateway.form.find(".input-text, select, input:checkbox").blur();var selector="";if($("#add_payment_method").length){selector=$("#add_payment_method")}if($("#order_review").length){selector=$("#order_review")}if($("form.checkout").length){selector=$("form.checkout")}if(selector.length){$("html, body").animate({scrollTop:selector.offset().top-100},500)}$(document.body).trigger("checkout_error");woocci_gateway.unblock()}};woocci_gateway.init();$(document.body).on("updated_cart_totals",function(){console.log("updated_cart_totals");if(woocci_params.inline_form==="1"){woocci_gateway.createElements()}});$(document.body).on("updated_checkout",function(){console.log("updated_checkout");if(woocci_params.inline_form==="1"){woocci_gateway.createElements()}})});